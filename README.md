# .NET SDK for Auth0 Fine Grained Authorization (FGA)

[![Nuget](https://img.shields.io/nuget/v/Auth0.Fga?label=Auth0.Fga&style=flat-square)](https://www.nuget.org/packages/Auth0.Fga)
[![Release](https://img.shields.io/github/v/release/auth0-lab/fga-dotnet-sdk?sort=semver&color=green)](https://github.com/auth0-lab/fga-dotnet-sdk/releases)
[![License](https://img.shields.io/badge/License-MIT-blue.svg)](./LICENSE)
[![FOSSA Status](https://app.fossa.com/api/projects/custom%2B4989%2Fgithub.com%2Fauth0-lab%2Ffga-dotnet-sdk.svg?type=shield)](https://app.fossa.com/api/projects/custom%2B4989%2Fgithub.com%2Fauth0-lab%2Ffga-dotnet-sdk.svg?type=shield)
[![Discord Server](https://img.shields.io/discord/759188666072825867?color=7289da&logo=discord "Discord Server")](https://discord.com/channels/759188666072825867/930524706854031421)
[![Twitter](https://img.shields.io/twitter/follow/Auth0Lab?color=%23179CF0&logo=twitter&style=flat-square "@Auth0Lab on Twitter")](https://twitter.com/Auth0Lab)

This is an autogenerated SDK for Auth0 Fine Grained Authorization (FGA). It provides a wrapper around the [Auth0 Fine Grained Authorization API](https://docs.fga.dev/api/service).

Warning: This SDK comes with no SLAs and is not production-ready!

## Table of Contents

- [About Auth0 Fine Grained Authorization (FGA)](#about)
- [Resources](#resources)
- [Installation](#installation)
- [Getting Started](#getting-started)
  - [Initializing the API Client](#initializing-the-api-client)
  - [Getting your Store ID, Client ID and Client Secret](#getting-your-store-id-client-id-and-client-secret)
  - [Calling the API](#calling-the-api)
    - [Write Authorization Model](#write-authorization-model)
    - [Read a Single Authorization Model](#read-a-single-authorization-model)
    - [Read Authorization Model IDs](#read-authorization-model-ids)
    - [Check](#check)
    - [Write Tuples](#write-tuples)
    - [Delete Tuples](#delete-tuples)
    - [Expand](#expand)
    - [Read](#read)
    - [Read Changes (Watch)](#read-changes-watch)
    - [List Objects](#list-objects)
  - [API Endpoints](#api-endpoints)
  - [Models](#models)
- [Contributing](#contributing)
  - [Issues](#issues)
  - [Pull Requests](#pull-requests) [Note: We are not accepting Pull Requests at this time!]
- [License](#license)

## About

[Auth0 Fine Grained Authorization (FGA)](https://fga.dev) is an open source Fine-Grained Authorization solution inspired by [Google's Zanzibar paper](https://research.google/pubs/pub48190/). It was created by the FGA team at [Auth0](https://auth0.com) based on [Auth0 Fine-Grained Authorization (FGA)](https://fga.dev), available under [a permissive license (Apache-2)](https://github.com/auth0-lab/rfcs/blob/main/LICENSE) and welcomes community contributions.

Auth0 Fine Grained Authorization (FGA) is designed to make it easy for application builders to model their permission layer, and to add and integrate fine-grained authorization into their applications. Auth0 Fine Grained Authorization (FGA)’s design is optimized for reliability and low latency at a high scale.

It allows in-memory data storage for quick development, as well as pluggable database modules - with initial support for PostgreSQL.

It offers an [HTTP API](https://docs.fga.dev/api/service) and has SDKs for programming languages including [Node.js/JavaScript](https://github.com/auth0-lab/js-sdk), [GoLang](https://github.com/auth0-lab/go-sdk) and [.NET](https://github.com/auth0-lab/dotnet-sdk).

More SDKs and integrations such as Rego are planned for the future.

## Resources

- [Auth0 Fine Grained Authorization (FGA) Documentation](https://docs.fga.dev)
- [Auth0 Fine Grained Authorization (FGA) API Documentation](https://docs.fga.dev/api/service)
- [Twitter](https://twitter.com/Auth0Lab)
- [Auth0 Fine Grained Authorization (FGA) Discord Community](https://discord.gg/8naAwJfWN6)
- [Zanzibar Academy](https://zanzibar.academy)
- [Google's Zanzibar Paper (2019)](https://research.google/pubs/pub48190/)

## Installation

The Auth0 Fine Grained Authorization (FGA) .NET SDK is available on [NuGet](https://www.nuget.org/).

You can install it using:

* The [dotnet CLI](https://docs.microsoft.com/en-us/nuget/consume-packages/install-use-packages-dotnet-cli)
```powershell
dotnet add package Auth0.Fga
```

* The [Package Manager Console](https://docs.microsoft.com/en-us/nuget/consume-packages/install-use-packages-powershell) inside Visual Studio:

```powershell
Install-Package Auth0.Fga
```

* [Visual Studio](https://docs.microsoft.com/en-us/nuget/consume-packages/install-use-packages-visual-studio), [Visual Studio for Mac](https://docs.microsoft.com/en-us/visualstudio/mac/nuget-walkthrough) and [IntelliJ Rider](https://www.jetbrains.com/help/rider/Using_NuGet.html)

Search for and install `Auth0.Fga` in each of their respective package manager UIs.


## Getting Started

### Initializing the API Client

```csharp
using Auth0.Fga.Api;
using Auth0.Fga.Client;
using Auth0.Fga.Configuration;
using Auth0.Fga.Model;

namespace Example {
    public class Example {
        public static void Main() {
            try {
                // See https://github.com/auth0-lab/fga-dotnet-sdk#getting-your-store-id-client-id-and-client-secret
                var environment = Environment.GetEnvironmentVariable(("AUTH0_FGA_ENVIRONMENT"), // can be = "us"/"staging"/"playground"
                var configuration = new Configuration(environment) {
                    StoreId = Environment.GetEnvironmentVariable(("AUTH0_FGA_STORE_ID"),
                    ClientId = Environment.GetEnvironmentVariable(("AUTH0_FGA_CLIENT_ID"), // Required for all environments except playground
                    ClientSecret = Environment.GetEnvironmentVariable(("AUTH0_FGA_CLIENT_SECRET"), // Required for all environments except playground
                };
                var auth0FgaApi = new Auth0FgaApi(configuration);
                var response = auth0FgaApi.ReadAuthorizationModels();
                Debug.WriteLine(response.AuthorizationModelIds);
            } catch (ApiException e) {
                 Debug.Print("Status Code: "+ e.ErrorCode);
            }
        }
    }
}
```


### Getting your Store ID, Client ID and Client Secret

#### Production

Make sure you have created your credentials on the Auth0 FGA Dashboard. [Learn how ➡](https://docs.fga.dev/intro/dashboard#create-api-credentials)

You will need to set the `AUTH0_FGA_ENVIRONMENT` variable to `"us"`. Provide the store id, client id and client secret you have created on the Dashboard.

#### Playground

If you are testing this on the public playground, you need to set your `AUTH0_FGA_ENVIRONMENT` to `"playground"`.

To get your store id, you may copy it from the store you have created on the [Playground](https://play.fga.dev). [Learn how ➡](https://docs.fga.dev/intro/playground#getting-store-id)

In the playground environment, you do not need to provide a client id and client secret.

### Calling the API

#### Write Authorization Model

[API Documentation](https://docs.fga.dev/api/service#/Authorization%20Models/WriteAuthorizationModel)

> Note: To learn how to build your authorization model, check the Docs at https://docs.fga.dev.

> Learn more about [the Auth0 Fine Grained Authorization (FGA) configuration language](https://docs.fga.dev/modeling/configuration-language).

```csharp
var documentRelations = new Dictionary<string, Userset>()
{
    {"writer", new Userset(_this: new object())},
    {
        "viewer",
        new Userset(union: new Usersets(new List<Userset>()
            {new(new object(), new ObjectRelation("", "writer"))}))
    }
};
var userRelations = new Dictionary<string, Userset>()
{
};

var body = new WriteAuthorizationModelRequest(new List<TypeDefinition>() {new("document", documentRelations), new("user", userRelations)});
var response = await auth0FgaApi.WriteAuthorizationModel(body);

// response.AuthorizationModelId = 1uHxCSuTP0VKPYSnkq1pbb1jeZw
```

#### Read a Single Authorization Model

[API Documentation](https://docs.fga.dev/api/service#/Authorization%20Models/ReadAuthorizationModel)

```csharp
string authorizationModelId = "1uHxCSuTP0VKPYSnkq1pbb1jeZw"; // Assuming `1uHxCSuTP0VKPYSnkq1pbb1jeZw` is an id of an existing model
var response = await auth0FgaApi.ReadAuthorizationModel(authorizationModelId);

// response.AuthorizationModel.Id = "1uHxCSuTP0VKPYSnkq1pbb1jeZw"
// response.AuthorizationModel.TypeDefinitions = [{ "type": "document", "relations": { ... } }, { "type": "user", "relations": { ... }}]
```

#### Read Authorization Model IDs

[API Documentation](https://docs.fga.dev/api/service#/Authorization%20Models/ReadAuthorizationModels)

```csharp
var response = await auth0FgaApi.ReadAuthorizationModels();

// response.AuthorizationModelIds = ["1uHxCSuTP0VKPYSnkq1pbb1jeZw", "GtQpMohWezFmIbyXxVEocOCxxgq"];
```

#### Check

[API Documentation](https://docs.fga.dev/api/service#/Relationship%20Queries/Check)

```csharp
var body =
    new CheckRequest{tupleKey: new TupleKey("document:roadmap", "viewer", "user:81684243-9356-4421-8fbf-a4f8d36aa31b"), AuthorizationModelId = "1uHxCSuTP0VKPYSnkq1pbb1jeZw"};
var response = await auth0FgaApi.Check(body);
// response.Allowed = true
```

#### Write Tuples

[API Documentation](https://docs.fga.dev/api/service#/Relationship%20Tuples/Write)

```csharp
var body = new WriteRequest{Writes = new TupleKeys(new List<TupleKey>
    {new("document:roadmap", "viewer", "user:81684243-9356-4421-8fbf-a4f8d36aa31b")}), AuthorizationModelId = "1uHxCSuTP0VKPYSnkq1pbb1jeZw"};
var response = await auth0FgaApi.Write(body);
```

#### Delete Tuples

[API Documentation](https://docs.fga.dev/api/service#/Relationship%20Tuples/Write)

```csharp
var body = new WriteRequest{Deletes = new TupleKeys(new List<TupleKey>
    {new("document:roadmap", "viewer", "user:81684243-9356-4421-8fbf-a4f8d36aa31b")}), AuthorizationModelId = "1uHxCSuTP0VKPYSnkq1pbb1jeZw"};
var response = await auth0FgaApi.Write(body);
```

#### Expand

[API Documentation](https://docs.fga.dev/api/service#/Relationship%20Queries/Expand)

```csharp
var body = new ExpandRequest{TupleKey = new TupleKey("document:roadmap", "viewer"), AuthorizationModelId = "1uHxCSuTP0VKPYSnkq1pbb1jeZw"};
var response = await auth0FgaApi.Expand(body);

// response.Tree.Root = {"name":"document:roadmap#viewer","leaf":{"users":{"users":["user:81684243-9356-4421-8fbf-a4f8d36aa31b","user:f52a4f7a-054d-47ff-bb6e-3ac81269988f"]}}}
```

#### Read Changes

[API Documentation](https://docs.fga.dev/api/service#/Relationship%20Tuples/Read)

```csharp
// Find if a relationship tuple stating that a certain user is a viewer of a certain document
var body = new ReadRequest(new TupleKey(
    _object: "document:roadmap",
    relation: "viewer",
    user: "user:81684243-9356-4421-8fbf-a4f8d36aa31b");

// Find all relationship tuples where a certain user has a relationship as any relation to a certain document
var body = new ReadRequest(new TupleKey(
    _object: "document:roadmap",
    user: "user:81684243-9356-4421-8fbf-a4f8d36aa31b"));

// Find all relationship tuples where a certain user is a viewer of any document
var body = new ReadRequest(new TupleKey(
    _object: "document:",
    relation: "viewer",
    user: "user:81684243-9356-4421-8fbf-a4f8d36aa31b"));

// Find all relationship tuples where any user has a relationship as any relation with a particular document
var body = new ReadRequest(new TupleKey(
    _object: "document:roadmap"));

// Read all stored relationship tuples
body := ReadRequest()

var response = await auth0FgaApi.Read(body);

// In all the above situations, the response will be of the form:
// response = {"tuples":[{"key":{"user":"...","relation":"...","object":"..."},"timestamp":"..."}]}
```

#### Read Changes (Watch)

[API Documentation](https://docs.fga.dev/api/service#/Relationship%20Tuples/ReadChanges)

```csharp
var type = 'document';
var pageSize = 25;
var continuationToken = 'eyJwayI6IkxBVEVTVF9OU0NPTkZJR19hdXRoMHN0b3JlIiwic2siOiIxem1qbXF3MWZLZExTcUoyN01MdTdqTjh0cWgifQ==';

var response = await auth0FgaApi.ReadChanges(type, pageSize, continuationToken);

// response.continuation_token = ...
// response.changes = [
//   { tuple_key: { user, relation, object }, operation: "writer", timestamp: ... },
//   { tuple_key: { user, relation, object }, operation: "viewer", timestamp: ... }
// ]
```

#### List Objects

[API Documentation](https://docs.fga.dev/api/service#/Relationship%20Queries/ListObjects)

```csharp
var body = new ListObjectsRequest{
    AuthorizationModelId = "1uHxCSuTP0VKPYSnkq1pbb1jeZw",
    User = "user:81684243-9356-4421-8fbf-a4f8d36aa31b",
    Relation = "viewer",
    Type = "document",
    ContextualTuples = new ContextualTupleKeys() {
        TupleKeys = new List<TupleKey> {
            new("document:budget", "writer", "user:81684243-9356-4421-8fbf-a4f8d36aa31b")
        }
    }
};
var response = await auth0FgaApi.ListObjects(body);

// response.Objects = ["document:roadmap"]
```


### API Endpoints

| Method | HTTP request | Description |
| ------------- | ------------- | ------------- |
| [**Check**](docs/Auth0FgaApi.md#check) | **POST** /stores/{store_id}/check | Check whether a user is authorized to access an object |
| [**Expand**](docs/Auth0FgaApi.md#expand) | **POST** /stores/{store_id}/expand | Expand all relationships in userset tree format, and following userset rewrite rules.  Useful to reason about and debug a certain relationship |
| [**ListObjects**](docs/Auth0FgaApi.md#listobjects) | **POST** /stores/{store_id}/list-objects | [EXPERIMENTAL] Get all objects of the given type that the user has a relation with |
| [**Read**](docs/Auth0FgaApi.md#read) | **POST** /stores/{store_id}/read | Get tuples from the store that matches a query, without following userset rewrite rules |
| [**ReadAssertions**](docs/Auth0FgaApi.md#readassertions) | **GET** /stores/{store_id}/assertions/{authorization_model_id} | Read assertions for an authorization model ID |
| [**ReadAuthorizationModel**](docs/Auth0FgaApi.md#readauthorizationmodel) | **GET** /stores/{store_id}/authorization-models/{id} | Return a particular version of an authorization model |
| [**ReadAuthorizationModels**](docs/Auth0FgaApi.md#readauthorizationmodels) | **GET** /stores/{store_id}/authorization-models | Return all the authorization model IDs for a particular store |
| [**ReadChanges**](docs/Auth0FgaApi.md#readchanges) | **GET** /stores/{store_id}/changes | Return a list of all the tuple changes |
| [**Write**](docs/Auth0FgaApi.md#write) | **POST** /stores/{store_id}/write | Add or delete tuples from the store |
| [**WriteAssertions**](docs/Auth0FgaApi.md#writeassertions) | **PUT** /stores/{store_id}/assertions/{authorization_model_id} | Upsert assertions for an authorization model ID |
| [**WriteAuthorizationModel**](docs/Auth0FgaApi.md#writeauthorizationmodel) | **POST** /stores/{store_id}/authorization-models | Create a new authorization model |



### Models

 - [Model.Any](docs/Any.md)
 - [Model.Assertion](docs/Assertion.md)
 - [Model.AuthErrorCode](docs/AuthErrorCode.md)
 - [Model.AuthenticationErrorMessageResponse](docs/AuthenticationErrorMessageResponse.md)
 - [Model.AuthorizationModel](docs/AuthorizationModel.md)
 - [Model.CheckRequest](docs/CheckRequest.md)
 - [Model.CheckResponse](docs/CheckResponse.md)
 - [Model.Computed](docs/Computed.md)
 - [Model.ContextualTupleKeys](docs/ContextualTupleKeys.md)
 - [Model.Difference](docs/Difference.md)
 - [Model.ErrorCode](docs/ErrorCode.md)
 - [Model.ExpandRequest](docs/ExpandRequest.md)
 - [Model.ExpandResponse](docs/ExpandResponse.md)
 - [Model.InternalErrorCode](docs/InternalErrorCode.md)
 - [Model.InternalErrorMessageResponse](docs/InternalErrorMessageResponse.md)
 - [Model.Leaf](docs/Leaf.md)
 - [Model.ListObjectsRequest](docs/ListObjectsRequest.md)
 - [Model.ListObjectsResponse](docs/ListObjectsResponse.md)
 - [Model.Metadata](docs/Metadata.md)
 - [Model.Node](docs/Node.md)
 - [Model.Nodes](docs/Nodes.md)
 - [Model.NotFoundErrorCode](docs/NotFoundErrorCode.md)
 - [Model.ObjectRelation](docs/ObjectRelation.md)
 - [Model.PathUnknownErrorMessageResponse](docs/PathUnknownErrorMessageResponse.md)
 - [Model.ReadAssertionsResponse](docs/ReadAssertionsResponse.md)
 - [Model.ReadAuthorizationModelResponse](docs/ReadAuthorizationModelResponse.md)
 - [Model.ReadAuthorizationModelsResponse](docs/ReadAuthorizationModelsResponse.md)
 - [Model.ReadChangesResponse](docs/ReadChangesResponse.md)
 - [Model.ReadRequest](docs/ReadRequest.md)
 - [Model.ReadResponse](docs/ReadResponse.md)
 - [Model.RelationMetadata](docs/RelationMetadata.md)
 - [Model.RelationReference](docs/RelationReference.md)
 - [Model.ResourceExhaustedErrorCode](docs/ResourceExhaustedErrorCode.md)
 - [Model.ResourceExhaustedErrorMessageResponse](docs/ResourceExhaustedErrorMessageResponse.md)
 - [Model.Status](docs/Status.md)
 - [Model.Tuple](docs/Tuple.md)
 - [Model.TupleChange](docs/TupleChange.md)
 - [Model.TupleKey](docs/TupleKey.md)
 - [Model.TupleKeys](docs/TupleKeys.md)
 - [Model.TupleOperation](docs/TupleOperation.md)
 - [Model.TupleToUserset](docs/TupleToUserset.md)
 - [Model.TypeDefinition](docs/TypeDefinition.md)
 - [Model.Users](docs/Users.md)
 - [Model.Userset](docs/Userset.md)
 - [Model.UsersetTree](docs/UsersetTree.md)
 - [Model.UsersetTreeDifference](docs/UsersetTreeDifference.md)
 - [Model.UsersetTreeTupleToUserset](docs/UsersetTreeTupleToUserset.md)
 - [Model.Usersets](docs/Usersets.md)
 - [Model.ValidationErrorMessageResponse](docs/ValidationErrorMessageResponse.md)
 - [Model.WriteAssertionsRequest](docs/WriteAssertionsRequest.md)
 - [Model.WriteAuthorizationModelRequest](docs/WriteAuthorizationModelRequest.md)
 - [Model.WriteAuthorizationModelResponse](docs/WriteAuthorizationModelResponse.md)
 - [Model.WriteRequest](docs/WriteRequest.md)



## Contributing

### Issues

If you have found a bug or if you have a feature request, please report them at this repository [issues](https://github.com/auth0-lab/fga-dotnet-sdk/issues) section. Please do not report security vulnerabilities on the public GitHub issue tracker.

### Pull Requests

Pull Requests are not currently open, please [raise an issue](https://github.com/auth0-lab/fga-dotnet-sdk/issues) or contact a team member on https://discord.gg/8naAwJfWN6 if there is a feature you'd like us to implement.

## Author

[Auth0 FGA](https://github.com/auth0-lab)

## License

This project is licensed under the MIT license. See the [LICENSE](https://github.com/auth0-lab/fga-dotnet-sdk/blob/main/LICENSE) file for more info.

The code in this repo was auto generated by [OpenAPI Generator](https://github.com/OpenAPITools/openapi-generator) from a template based on the [csharp-netcore template](https://github.com/OpenAPITools/openapi-generator/tree/master/modules/openapi-generator/src/main/resources/csharp-netcore), licensed under the [Apache License 2.0](https://github.com/OpenAPITools/openapi-generator/blob/master/LICENSE).

